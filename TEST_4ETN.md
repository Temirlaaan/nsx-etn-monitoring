# üß™ –¢–ï–°–¢–û–í–´–ô –ó–ê–ü–£–°–ö - 4 ETN

## –¶–µ–ª—å
–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å –Ω–∞ 4 –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö Edge Transport Nodes:
- 10.11.35.7
- 10.11.35.8
- 10.11.35.2
- 10.11.35.11

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫

### 1. –î–æ–±–∞–≤—å—Ç–µ –≤ .env —Ñ–∞–π–ª

```env
# ... (–æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–∞–∫ –æ–±—ã—á–Ω–æ)

# ETN Whitelist –¥–ª—è —Ç–µ—Å—Ç–∞ (–î–û–ë–ê–í–ò–¢–¨ –≠–¢–£ –°–¢–†–û–ö–£)
ETN_WHITELIST=10.11.35.7,10.11.35.8,10.11.35.2,10.11.35.11
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å

```bash
# –° Docker
docker-compose up -d

# –ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ
python -m uvicorn app.main:app --host 0.0.0.0 --port 8000
```

### 3. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

```
http://localhost:8000
```

**–í—ã —É–≤–∏–¥–∏—Ç–µ —Ç–æ–ª—å–∫–æ 4 ETN –≤ —Å–ø–∏—Å–∫–µ!** ‚úÖ

---

## üìã –ü–æ–ª–Ω—ã–π .env –¥–ª—è —Ç–µ—Å—Ç–∞

```env
# NSX-T Manager
NSX_MANAGER_URL=https://nsx01cast.t-cloud.kz
NSX_USERNAME=tadm.bisengaliyev@t-cloud.kz
NSX_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å

# ETN SSH (–≤ –∫–∞–≤—ã—á–∫–∞—Ö –µ—Å–ª–∏ –µ—Å—Ç—å # –≤ –ø–∞—Ä–æ–ª–µ)
ETN_SSH_USERNAME=root
ETN_SSH_PASSWORD="–≤–∞—à_–ø–∞—Ä–æ–ª—å"
ETN_SSH_PORT=22

# Telegram (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
TELEGRAM_BOT_TOKEN=8503169767:AAHUyYkUy...
TELEGRAM_CHAT_ID=-5029880920

# Scheduler Configuration
NSX_CHECK_CRON=0 2 */2 * *
CERT_CHECK_CRON=0 3 * * 1

# Certificate Expiry Warning
CERT_WARNING_DAYS=30

# !!! –¢–ï–°–¢–û–í–´–ô WHITELIST - –¢–û–õ–¨–ö–û 4 ETN !!!
ETN_WHITELIST=10.11.35.7,10.11.35.8,10.11.35.2,10.11.35.11

# Database
DATABASE_URL=sqlite+aiosqlite:///./etn_monitor.db

# Web Server
WEB_HOST=0.0.0.0
WEB_PORT=8000
```

---

## üîç –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç

### –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ:
1. ‚úÖ –ü–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ NSX –∏ –ø–æ–ª—É—á–∏—Ç –≤—Å–µ 193 transport nodes
2. ‚úÖ –û—Ç—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ EdgeNode (114 —à—Ç—É–∫)
3. ‚úÖ **–ü—Ä–∏–º–µ–Ω–∏—Ç whitelist - –æ—Å—Ç–∞–≤–∏—Ç —Ç–æ–ª—å–∫–æ 4 ETN**
4. ‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç —Ç–æ–ª—å–∫–æ —ç—Ç–∏ 4 –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
5. ‚úÖ (–ï—Å–ª–∏ Telegram –Ω–∞—Å—Ç—Ä–æ–µ–Ω) –û—Ç–ø—Ä–∞–≤–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ 4 –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö ETN

### –í –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:
```
–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
- –í—Å–µ–≥–æ ETN: 4
- –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã OK: X
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: Y
- –∏ —Ç.–¥.

–¢–∞–±–ª–∏—Ü–∞ –ø–æ–∫–∞–∂–µ—Ç —Ç–æ–ª—å–∫–æ:
- 10.11.35.7
- 10.11.35.8
- 10.11.35.2
- 10.11.35.11
```

### –ü–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é:
- **NSX –ø—Ä–æ–≤–µ—Ä–∫–∞** - –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –≤—Å–µ ETN, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑ whitelist
- **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤** - –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–æ–ª—å–∫–æ —ç—Ç–∏ 4 —Ö–æ—Å—Ç–∞
- **Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - —Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–∏—Ö 4 —Ö–æ—Å—Ç–æ–≤

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

### –¢–µ—Å—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–∂–¥—ã–π —Ö–æ—Å—Ç –æ—Ç–¥–µ–ª—å–Ω–æ
python test_simple.py 10.11.35.7 root "password"
python test_simple.py 10.11.35.8 root "password"
python test_simple.py 10.11.35.2 root "password"
python test_simple.py 10.11.35.11 root "password"
```

### –¢–µ—Å—Ç NSX:
```bash
python test_nsx_auth.py
# –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å 114 ETN, –Ω–æ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –±—É–¥–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
```

---

## üöÄ –ó–∞–ø—É—Å–∫

```bash
# 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env
cat .env | grep ETN_WHITELIST
# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: ETN_WHITELIST=10.11.35.7,10.11.35.8,10.11.35.2,10.11.35.11

# 2. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ë–î
mkdir -p data

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å Docker
docker-compose up -d

# 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
docker-compose logs -f
```

**–õ–æ–≥–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–∫–∞–∑–∞—Ç—å:**
```
ETN Whitelist enabled: ['10.11.35.7', '10.11.35.8', '10.11.35.2', '10.11.35.11']
Filtered 4 Edge Transport Nodes (whitelist applied)
```

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ UI

### Dashboard –ø–æ–∫–∞–∂–µ—Ç:
- **–í—Å–µ–≥–æ ETN:** 4
- **–°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã OK:** 4 (–µ—Å–ª–∏ –≤—Å–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –≤–∞–ª–∏–¥–Ω—ã)
- –¢–∞–±–ª–∏—Ü–∞ —Å 4 —Å—Ç—Ä–æ–∫–∞–º–∏

### –í —Ç–∞–±–ª–∏—Ü–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ ETN:
| –ò–º—è ETN | IP | –†–µ–∂–∏–º | –î–∞—Ç–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è | –î–Ω–µ–π –æ—Å—Ç–∞–ª–æ—Å—å | –°—Ç–∞—Ç—É—Å |
|---------|----|----|----------------|---------------|--------|
| esg-ast-interconnect01 | 10.11.35.7 | DISABLED | 2028-02-02 | 821 | üü¢ OK |
| esg-ast-interconnect02 | 10.11.35.8 | DISABLED | 2028-02-02 | 821 | üü¢ OK |
| ... | 10.11.35.2 | ... | ... | ... | ... |
| ... | 10.11.35.11 | ... | ... | ... | ... |

---

## üîÑ –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –≤—Å–µ ETN

–ö–æ–≥–¥–∞ —Ç–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω –∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ—Å—Ç–æ:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –£–¥–∞–ª–∏—Ç—å whitelist
```env
# –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –ø—É—Å—Ç—ã–º
ETN_WHITELIST=
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É –ø–æ–ª–Ω–æ—Å—Ç—å—é
```env
# –ü—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç–µ —Å—Ç—Ä–æ–∫—É ETN_WHITELIST –∏–∑ .env
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å:
```bash
docker-compose restart
```

**–¢–µ–ø–µ—Ä—å –±—É–¥—É—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å—Å—è –≤—Å–µ 114 ETN!** üéâ

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –í UI –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ 114 ETN, –∞ –Ω–µ 4

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª
```bash
cat .env | grep ETN_WHITELIST
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: ETN_WHITELIST=10.11.35.7,10.11.35.8,10.11.35.2,10.11.35.11
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:
```bash
docker-compose restart
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ 4 ETN –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. IP –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ NSX (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ `python test_nsx_auth.py`)
2. –û–ø–µ—á–∞—Ç–∫–∞ –≤ IP –∞–¥—Ä–µ—Å–µ –≤ whitelist
3. ETN –Ω–µ —è–≤–ª—è–µ—Ç—Å—è EdgeNode —Ç–∏–ø–æ–º

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
docker-compose logs | grep -i whitelist
docker-compose logs | grep -i filtered
```

---

## üí° –°–æ–≤–µ—Ç

**–î–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∞:**

1. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∫–æ—Ä–æ—Ç–∫–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –≤ .env:
```env
# –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –≤–º–µ—Å—Ç–æ –Ω–µ–¥–µ–ª–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∞!)
CERT_CHECK_CRON=*/5 * * * *
```

2. ‚úÖ –ò–ª–∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ API:
```bash
# TODO: –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å endpoint –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
```

---

**–ì–æ—Ç–æ–≤–æ! –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ 4 ETN!** üöÄ
